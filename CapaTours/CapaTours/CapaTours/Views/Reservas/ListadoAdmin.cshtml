@model List<CapaTours.Models.ReservaAdminModel>

<div class="row px-5">
	<div class="col-12">
		<div class="row">
			<div class="col-6">
				<div class="display-3 px-0">Reservas</div>
				<div class="text-muted px-0 ">Listado de todas las reservas registradas en el sistema.</div>
				<br>
			</div>
		</div>


		<div class="row mt-3 mb-2"></div>
		<div class="row">
			<div class="col-12 px-0">
				<div class="table-responsive shadow-lg" style="background-color: #f9f9f9; border-left: 5px solid #44572f; border-radius: 10px;">
					<table id="example" class="table table-bordered table-hover">
						<thead>
							<tr>
								<th>ID de Reserva</th>
								<th>Tour</th>
								<th>Cliente</th>
								<th>Identificación</th>							
								<th>Cantidad de Personas</th>
								<th>Estado</th>
								<th>Acciones</th>
							</tr>
						</thead>
						<tbody>
@foreach (var item in Model)
{
    <tr>
        <td>@item.ReservaID</td>
        <td>@item.NombreTour</td>
        <td>@item.Cliente</td>
        <td>@item.Identificacion</td>
        <td>@item.CantidadPersonas</td>
        <td>@item.Estado</td>
        <td class="text-center">
		<button class="btn btn-sm btn-ver-comprobante"
	    style="background-color: #7B9C36; color: white"
		data-bs-toggle="modal"
		data-bs-target="#verComprobanteModal"
		data-comprobante="@item.Comprobante"
		data-fecha="@item.Fecha.ToString("yyyy-MM-dd")"
		data-monto="@item.Monto">
		<i class="fa-solid fa-eye"></i> Ver Comprobante
		</button>
            <button class="btn btn-sm btn-danger me-1" data-bs-toggle="modal" data-bs-target="#cancelarReservaModal">
                <i class="fa-regular fa-circle-xmark"></i> Cancelar Reserva
            </button>
        </td>
    </tr>
}
</tbody>

					</table>
				</div>
			</div>
		</div>
	</div>
</div>


@* Modal de Comprobante *@
<div class="modal fade" id="verComprobanteModal" tabindex="-1" aria-labelledby="verComprobanteModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="verComprobanteModalLabel">Ver Comprobante</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<div class="mb-3 text-center">
					<img id="comprobanteImagen" src="#" alt="Comprobante" class="img-fluid border rounded" style="max-height: 300px;">
				</div>
				<div class="mb-3">
					<label for="fechaComprobante" class="form-label">Fecha</label>
					<input type="date" id="fechaComprobante" class="form-control" readonly>
				</div>
				<div class="mb-3">
					<label for="montoComprobante" class="form-label">Monto</label>
					<input type="number" id="montoComprobante" class="form-control" readonly>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
			</div>
		</div>
	</div>
</div>

@* Modal de Cancelar Reserva *@
<div class="modal fade" id="cancelarReservaModal" tabindex="-1" aria-labelledby="cancelarReservaModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="cancelarReservaModalLabel">Confirmar Cancelación</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<p>¿Está seguro de que desea cancelar esta reserva?</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
				<button type="button" class="btn btn-danger">Cancelar</button>
			</div>
		</div>
	</div>
</div>

@* DataTable *@
<script>
	$(document).ready(function () {

		$("#example").DataTable({
			language: {
				url: '//cdn.datatables.net/plug-ins/2.1.8/i18n/es-ES.json',
			},
			responsive: true,
			columnDefs: [
				{
					targets: [2],
					className: 'text-center'
				}
			],
			order: [[0, 'desc']]
		});

	});
		// Cargar datos en el modal "Ver Comprobante"
			$('.btn-ver-comprobante').on('click', function () {
				const comprobante = $(this).data('comprobante');
				const fecha = $(this).data('fecha');
				const monto = $(this).data('monto');

				$('#comprobanteImagen').attr('src', comprobante);
				$('#fechaComprobante').val(fecha);
				$('#montoComprobante').val(monto);
			});
		});
</script>